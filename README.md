# SplitTypingPlugin

一个模拟人类打字习惯的消息分段发送插件。会根据标点符号和特殊格式自动分段，并模拟真实的打字速度发送消息。

## 安装方法

配置完成 [LangBot](https://github.com/RockChinQ/LangBot) 主程序后使用管理员账号向机器人发送命令即可安装：

```
!plugin get https://github.com/sanxianxiaohuntun/SplitTypingPlugin
```

![2893784b8fb06f64e71885043eeb947c](https://github.com/user-attachments/assets/83436b58-84fb-4468-8e5d-0c34bba961db)

## 功能特点

- 自动分段：根据标点符号(。！，等)和特殊格式(括号、数字)自动分段
- 打字机效果：模拟人类打字速度，按字符数计算发送延迟
- 智能分段：超过配置的最大长度将不再分段发送
- 分段开关：支持群聊/私聊分别开启或关闭分段功能
- 消息排队：同一对话中的消息会按顺序发送，不会互相打断



## 使用方法

插件会自动拦截大模型的回复，进行智能分段并延迟发送，无需手动操作。

### 命令列表

插件支持以下命令：

- `/开启分段` - 开启分段发送功能
- `/关闭分段` - 关闭分段发送功能
- `/设置分段字符限制 [数字]` - 设置超过多少字符的消息不分段（0表示不限制）

## 配置说明

配置文件位于`config.yaml`，可以根据需要调整以下参数：

```yaml
# 每个字符的延迟时间(秒)，控制打字速度
delay_per_char: 0.5

# 是否启用分段发送功能
enable_split: true

# 超过该字符数的消息将不会分段 (设为0表示不限制)
max_chars_for_split: 100

# 需要保留的标点符号列表
keep_punctuation:
  - '？'
  - '！'
  - '?'
  - '!'
  - '〜'

# 需要删除的标点符号列表
skip_punctuation:
  - '，'
  - '。'
  - ','
  - '.'
  - ':'
  - '：'
  - '\n'

# 用于分段的标点符号列表
split_punctuation:
  - '？'
  - '！'
  - '?'
  - '!'
  - '~'
  - '〜'
```

### 参数说明

- `delay_per_char`: 每个字符的延迟时间（秒），默认0.5秒
- `enable_split`: 是否启用分段功能，设为false则只进行延迟发送
- `max_chars_for_split`: 字符长度阈值，超过该值的消息不会分段，设为0表示不限制
- `keep_punctuation`: 需要保留的标点符号列表
- `skip_punctuation`: 需要删除的标点符号列表
- `split_punctuation`: 用于分段的标点符号列表

## 分段规则说明

- 括号内的内容会被视为一个独立分段
- 遇到分段标点符号（如问号、感叹号等）会进行分段
- 会忽略指定的需要删除的标点符号（如逗号、句号等）
- 超过设定字符数的消息将不会被分段处理

## 示例效果

原始消息：
```
我是谁（提问），我到底是谁？究竟是谁。
```

分段效果：
```
我是谁
（提问）
我到底是谁？
究竟是谁
```

## 长消息处理

当消息字符数超过设定的阈值（默认100个字符）时：
```
这是一段非常长的消息，包含了超过100个字符的内容...（此处省略大量文本）...所以这种情况下会作为单条消息发送，不会进行分段处理。
```

分段效果：
```
这是一段非常长的消息，包含了超过100个字符的内容...（此处省略大量文本）...所以这种情况下会作为单条消息发送，不会进行分段处理。
```

## 注意事项

1. 分段后每个分段会根据字符数量按比例延迟发送
2. 如果只有一个分段，则不会启用延迟发送
3. 修改配置文件后需要重启插件才能生效
4. 可以使用命令在对话中实时开启或关闭分段功能
5. 对于超长消息，无论是否开启分段功能，都会按照字符长度阈值自动判断 

## 作者

小馄饨
